{"version":3,"sources":["addItemToCart.js"],"names":["handler","req","res","method","body","cartId","lineItems","console","log","query","process","env","SHOPIFY_DOMAIN","headers","SHOPIFY_PUB","JSON","stringify","variables","lines","response","json","data","status","cartLinesAdd","userErrors","length","error","setHeader","end"],"mappings":";;;;;;;AAAA;;;;AAEe,SAAeA,OAAf,CAAuBC,GAAvB,EAA4BC,GAA5B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,gBACPD,GAAG,CAACE,MAAJ,KAAe,MADR;AAAA;AAAA;AAAA;;AAAA;AAAA,sBAG2BF,GAAG,CAACG,IAH/B,EAGKC,MAHL,aAGKA,MAHL,EAGaC,SAHb,aAGaA,SAHb;AAIHC,UAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ,EAAoBC,SAApB;AAEMG,UAAAA,KANH;AAAA;AAAA,0CAkDoB,6CAAiBC,OAAO,CAACC,GAAR,CAAYC,cAA7B,gCAAwE;AAC3FT,YAAAA,MAAM,EAAE,MADmF;AAE3FU,YAAAA,OAAO,EAAE;AACL,8BAAgB,kBADX;AAEL,mDAAqCH,OAAO,CAACC,GAAR,CAAYG;AAF5C,aAFkF;AAM3FV,YAAAA,IAAI,EAAEW,IAAI,CAACC,SAAL,CAAe;AACjBP,cAAAA,KAAK,EAALA,KADiB;AAEjBQ,cAAAA,SAAS,EAAE;AAAEZ,gBAAAA,MAAM,EAANA,MAAF;AAAUa,gBAAAA,KAAK,EAAEZ;AAAjB;AAFM,aAAf;AANqF,WAAxE,CAlDpB;;AAAA;AAkDGa,UAAAA,QAlDH;AAAA;AAAA,0CAgEgBA,QAAQ,CAACC,IAAT,EAhEhB;;AAAA;AAgEGC,UAAAA,IAhEH;AAiEHnB,UAAAA,GAAG,CAACoB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqBC,IAArB,EAjEG,CAmEH;;AACA,cAAIA,IAAI,CAACA,IAAL,IAAaA,IAAI,CAACA,IAAL,CAAUE,YAAvB,IAAuCF,IAAI,CAACA,IAAL,CAAUE,YAAV,CAAuBC,UAAlE,EAA8E;AAC1E,gBAAIH,IAAI,CAACA,IAAL,CAAUE,YAAV,CAAuBC,UAAvB,CAAkCC,MAAlC,GAA2C,CAA/C,EAAkD;AAC9ClB,cAAAA,OAAO,CAACmB,KAAR,CAAc,cAAd,EAA8BL,IAAI,CAACA,IAAL,CAAUE,YAAV,CAAuBC,UAArD;AACH;AACJ,WAJD,MAIO;AACHjB,YAAAA,OAAO,CAACmB,KAAR,CAAc,gCAAd,EAAgDL,IAAhD;AACH;;AA1EE;AAAA;;AAAA;AAAA;AAAA;AA6EHd,UAAAA,OAAO,CAACmB,KAAR;AACAxB,UAAAA,GAAG,CAACoB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAAEM,YAAAA,KAAK,EAAE;AAAT,WAArB;;AA9EG;AAAA;AAAA;;AAAA;AAiFPxB,UAAAA,GAAG,CAACyB,SAAJ,CAAc,OAAd,EAAuB,CAAC,MAAD,CAAvB;AACAzB,UAAAA,GAAG,CAACoB,MAAJ,CAAW,GAAX,EAAgBM,GAAhB,kBAA8B3B,GAAG,CAACE,MAAlC;;AAlFO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import fetch from 'node-fetch';\n\nexport default async function handler(req, res) {\n    if (req.method === \"POST\") {\n        try {\n            const { cartId, lineItems } = req.body;\n            console.log(cartId, lineItems);\n\n            const query = `\n                mutation addCartLines($cartId: ID!, $lines: [CartLineInput!]!) {\n                    cartLinesAdd(cartId: $cartId, lines: $lines) {\n                        cart {\n                            id\n                            lines(first: 10) {\n                                edges {\n                                    node {\n                                        quantity\n                                        merchandise {\n                                            ... on ProductVariant {\n                                                id\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                            cost {\n                                totalAmount {\n                                    amount\n                                    currencyCode\n                                }\n                                subtotalAmount {\n                                    amount\n                                    currencyCode\n                                }\n                                totalTaxAmount {\n                                    amount\n                                    currencyCode\n                                }\n                                totalDutyAmount {\n                                    amount\n                                    currencyCode\n                                }\n                            }\n                        }\n                        userErrors {\n                            field\n                            message\n                        }\n                    }\n                }\n            `;\n\n            const response = await fetch(`https://${process.env.SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {\n                method: \"POST\",\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-Shopify-Storefront-Access-Token': process.env.SHOPIFY_PUB\n                },\n                body: JSON.stringify({\n                    query,\n                    variables: { cartId, lines: lineItems }\n                })\n            })\n\n            \n            \n            const data = await response.json();\n            res.status(200).json(data)\n\n            // Check if cartLinesAdd is available and has userErrors\n            if (data.data && data.data.cartLinesAdd && data.data.cartLinesAdd.userErrors) {\n                if (data.data.cartLinesAdd.userErrors.length > 0) {\n                    console.error('User errors:', data.data.cartLinesAdd.userErrors);\n                }\n            } else {\n                console.error('Unexpected response structure:', data);\n            }\n\n        } catch (error) {\n            console.error(error);\n            res.status(500).json({ error: 'Error adding items to cart' })\n        }\n    } else {\n        res.setHeader('Allow', ['POST']);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}"],"file":"addItemToCart.dev.js"}