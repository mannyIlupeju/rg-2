{"version":3,"sources":["cart.js"],"names":["handler","req","res","method","productAdded","body","console","log","lineItems","merchandiseId","id","quantity","query","process","env","SHOPIFY_DOMAIN","headers","SHOPIFY_PUB","JSON","stringify","variables","cartInput","lines","response","json","data","status","error","setHeader","end"],"mappings":";;;;;;;AAAA;;;;AAEe,SAAeA,OAAf,CAAuBC,GAAvB,EAA4BC,GAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACPD,GAAG,CAACE,MAAJ,KAAe,MADR;AAAA;AAAA;AAAA;;AAAA;AAGKC,UAAAA,YAHL,GAGsBH,GAAG,CAACI,IAH1B,CAGKD,YAHL,EAGgC;;AACnCE,UAAAA,OAAO,CAACC,GAAR,CAAYH,YAAZ,EAJG,CAKH;;AACMI,UAAAA,SANH,GAMgB;AACfC,YAAAA,aAAa,EAAEC,EADA;AAEfC,YAAAA,QAAQ,EAAEA,QAFK,CAEI;;AAFJ,WANhB;AAWGC,UAAAA,KAXH;AAAA;AAAA,0CA0DoB,6CAAiBC,OAAO,CAACC,GAAR,CAAYC,cAA7B,gCAAwE;AAC3FZ,YAAAA,MAAM,EAAE,MADmF;AAE3Fa,YAAAA,OAAO,EAAE;AACL,8BAAgB,kBADX;AAEL,mDAAqCH,OAAO,CAACC,GAAR,CAAYG;AAF5C,aAFkF;AAM3FZ,YAAAA,IAAI,EAAEa,IAAI,CAACC,SAAL,CAAe;AACjBP,cAAAA,KAAK,EAALA,KADiB;AAEjBQ,cAAAA,SAAS,EAAE;AAAEC,gBAAAA,SAAS,EAAE;AAAEC,kBAAAA,KAAK,EAAEd;AAAT;AAAb;AAFM,aAAf;AANqF,WAAxE,CA1DpB;;AAAA;AA0DGe,UAAAA,QA1DH;AAAA;AAAA,0CAsEgBA,QAAQ,CAACC,IAAT,EAtEhB;;AAAA;AAsEGC,UAAAA,IAtEH;AAuEHvB,UAAAA,GAAG,CAACwB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqBC,IAArB;AACAnB,UAAAA,OAAO,CAACC,GAAR,CAAYkB,IAAZ;AAxEG;AAAA;;AAAA;AAAA;AAAA;AA2EHnB,UAAAA,OAAO,CAACqB,KAAR;AACAzB,UAAAA,GAAG,CAACwB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAAEG,YAAAA,KAAK,EAAE;AAAT,WAArB;;AA5EG;AAAA;AAAA;;AAAA;AA+EPzB,UAAAA,GAAG,CAAC0B,SAAJ,CAAc,OAAd,EAAuB,CAAC,MAAD,CAAvB;AACA1B,UAAAA,GAAG,CAACwB,MAAJ,CAAW,GAAX,EAAgBG,GAAhB,kBAA8B5B,GAAG,CAACE,MAAlC;;AAhFO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["import fetch from 'node-fetch'\n\nexport default async function handler(req, res) {\n    if (req.method === \"POST\") {\n        try {\n            const { productAdded } = req.body; // `variants` is an array of variant IDs\n            console.log(productAdded);\n            // Construct line items using the same quantity for each variant\n            const lineItems = ({\n                merchandiseId: id,\n                quantity: quantity // Using the same quantity for each variant\n            });\n\n            const query = `\n                mutation createCart($cartInput: CartInput) {\n                cartCreate(input: $cartInput) {\n                    cart {\n                    id\n                    createdAt\n                    updatedAt\n                    checkoutUrl\n                    lines(first: 10) {\n                        edges {\n                        node {\n                            id\n                            merchandise {\n                            ... on ProductVariant {\n                                id\n                            }\n                            }\n                        }\n                        }\n                    }\n                    attributes {\n                        key\n                        value\n                    }\n                    cost {\n                        totalAmount {\n                        amount\n                        currencyCode\n                        }\n                        subtotalAmount {\n                        amount\n                        currencyCode\n                        }\n                        totalTaxAmount {\n                        amount\n                        currencyCode\n                        }\n                        totalDutyAmount {\n                        amount\n                        currencyCode\n                        }\n                    }\n                    }\n                }\n                }\n            `;\n\n            const response = await fetch(`https://${process.env.SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {\n                method: \"POST\",\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-Shopify-Storefront-Access-Token': process.env.SHOPIFY_PUB\n                },\n                body: JSON.stringify({\n                    query,\n                    variables: { cartInput: { lines: lineItems } }\n                })\n            })\n\n            const data = await response.json();\n            res.status(200).json(data)\n            console.log(data);\n\n        } catch (error) {\n            console.error(error);\n            res.status(500).json({ error: 'Error creating cart' })\n        }\n    } else {\n        res.setHeader('Allow', ['POST']);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}        "],"file":"cart.dev.js"}